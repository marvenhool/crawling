# This Python file uses the following encoding: utf-8
# abc
import crawling_module
import time
import random
import urllib2
import exceptions
import string
import re
#####システムのディフォルトコードセットをUTF-８に設定、
#####でないとASCIIコード直接ファイルに書き込みできない可能性が高いですから、エラー出る
import sys
reload(sys)
sys.setdefaultencoding("utf-8")


def proxy_test(proxy_list):

    for proxy in proxy_list:
        buf = get_url_source_by_proxy('http://tabelog.com/tokyo/A1307/A130701/13001058/', proxy, 'UTF-8')
        if buf is None:
            pass
        elif buf.find('アクセスが制限されています') != -1:
            pass
        else:
            crawling_module.write_text_to_file_by_utf8('useful_proxy.csv', proxy, 0)



def get_url_source_by_proxy(url,  proxy_address, charset):
    html = None
    try:
        proxy = {'http': proxy_address}
        proxy_handler = urllib2.ProxyHandler(proxy)
        opener = urllib2.build_opener(proxy_handler)
        urllib2.install_opener(opener)
        html = urllib2.urlopen(url, timeout=5).read() #5 secends time out ,return false
        html = html.decode(charset).encode('utf-8')
    except exceptions.Exception, e:
        print e
        print proxy_address
        html = None
    finally:
        return html

proxy_list = ['http://101.227.252.130:8081','http://101.255.74.58:8080','http://101.4.136.34:9999','http://101.69.180.85:443','http://101.69.180.85:80','http://101.71.27.120:80','http://101.71.27.27:8000','http://101.79.241.40:8080','http://103.11.116.46:80','http://103.246.244.161:44338','http://103.3.78.218:8080','http://106.186.123.92:3128','http://106.187.43.78:3128','http://109.107.133.46:8080','http://109.196.127.35:8888','http://109.224.45.205:8080','http://109.228.29.137:3128','http://110.138.179.12:3128','http://110.169.186.75:3128','http://110.173.0.58:80','http://110.173.0.58:8080','http://110.4.12.173:80','http://110.4.12.178:80','http://110.4.24.176:80','http://110.4.24.178:80','http://111.1.32.118:8080','http://111.1.36.10:80','http://111.1.36.130:80','http://111.1.36.133:80','http://111.1.36.6:80','http://111.1.61.23:8080','http://111.12.128.135:80','http://111.12.128.166:80','http://111.12.128.167:80','http://111.12.128.171:80','http://111.12.128.171:8001','http://111.12.128.171:8060','http://111.12.128.171:8080','http://111.12.128.171:83','http://111.12.128.171:9000','http://111.12.128.171:9064','http://111.12.128.171:9797','http://111.12.128.172:80','http://111.12.128.172:8080','http://111.12.128.172:8085','http://111.12.128.172:8085',       'http://111.12.128.172:8088','http://111.12.128.172:8089','http://111.12.128.172:81','http://111.13.12.202:80','http://111.13.12.216:80','http://111.13.136.57:843','http://111.13.136.58:80','http://111.13.136.58:843','http://111.13.136.59:80','http://111.13.136.59:843','http://111.13.65.124:80','http://111.13.65.125:80','http://111.161.126.100:80','http://111.161.126.101:80','http://111.161.126.98:80','http://111.161.126.99:80','http://111.193.66.195:9000','http://111.193.71.113:9000','http://111.206.50.177:80','http://111.206.81.248:80','http://111.40.196.68:80','http://112.105.11.194:8088','http://112.112.11.82:8080','http://112.18.63.8:8123','http://112.19.218.110:8123','http://112.196.37.228:3128','http://112.78.1.36:3128','http://113.105.224.87:80','http://113.207.128.129:80','http://113.207.129.129:80','http://113.207.130.166:80','http://113.214.13.1:8000','http://113.255.97.186:80','http://114.226.75.29:8118','http://114.255.183.163:8080','http://114.255.183.164:8080','http://114.255.183.189:8080','http://114.6.34.194:8080','http://114.6.52.130:8080','http://114.80.182.132:80','http://115.127.9.170:8080','http://115.231.96.120:80','http://115.238.225.26:80','http://115.239.210.199:80','http://115.248.188.230:8080','http://116.236.216.116:8080','http://116.50.25.181:8585','http://117.102.163.5:80','http://117.135.194.53:80','http://117.135.250.11:80','http://117.135.250.51:80','http://117.135.250.51:82','http://117.135.250.51:86','http://117.135.250.54:80','http://117.135.250.54:82','http://117.135.250.54:84','http://117.135.250.55:80','http://117.135.250.55:81','http://117.135.250.55:82','http://117.135.250.56:80','http://117.135.250.68:86','http://117.135.250.83:80','http://117.135.250.84:80','http://117.135.250.9:80','http://117.135.251.74:80','http://117.135.251.74:82','http://117.135.251.75:80','http://117.135.251.75:82','http://117.135.251.76:80','http://117.135.251.76:82','http://117.135.251.78:80','http://117.135.251.78:82','http://117.135.252.14:80','http://117.135.252.14:81','http://117.135.252.14:82','http://117.135.252.14:84','http://117.164.54.164:8123','http://117.165.214.243:8123','http://117.167.22.105:8123','http://117.167.64.196:8123','http://117.169.64.4:80','http://117.170.11.201:8123','http://117.170.161.163:8123','http://117.173.23.47:8123','http://117.175.59.121:8123','http://117.175.63.197:8123','http://117.218.227.131:8080','http://117.52.97.210:3128','http://117.59.224.106:80','http://117.59.224.106:8080','http://117.79.64.84:80','http://117.79.64.86:80','http://118.163.165.250:3128','http://118.174.10.193:3128','http://118.186.201.187:80','http://119.110.81.101:3128','http://119.40.98.26:8080','http://119.6.144.74:80','http://119.6.144.74:81','http://119.6.144.74:82','http://119.6.144.74:83','http://119.6.144.74:843','http://119.90.127.2:80','http://119.90.127.3:80','http://119.90.127.5:80','http://120.131.128.209:80','http://120.131.128.211:80','http://120.131.128.214:80','http://120.192.249.74:80','http://120.193.146.95:81','http://120.193.146.95:82','http://120.193.146.95:83','http://120.193.146.95:843','http://120.197.234.166:80','http://120.198.243.111:80','http://120.198.243.113:80','http://120.198.243.114:80','http://120.198.243.115:8080','http://120.198.243.115:8888','http://120.198.243.116:80','http://120.198.243.118:80','http://120.198.243.130:80','http://120.198.243.131:80','http://120.198.243.14:80','http://120.198.243.151:80','http://120.198.243.15:80','http://120.198.243.3:80','http://120.198.243.50:80','http://120.198.243.51:80','http://120.198.243.52:80','http://120.198.243.53:80','http://120.198.243.54:80','http://120.198.243.78:80','http://120.198.243.79:80','http://120.198.243.82:80','http://120.198.243.83:80','http://120.198.243.86:80','http://120.236.148.113:3128','http://120.83.5.164:18000','http://121.201.18.74:3128','http://121.243.51.107:80','http://121.243.51.107:8080','http://122.225.106.35:80','http://122.96.59.106:80','http://122.96.59.106:82','http://122.96.59.106:83','http://122.96.59.106:843','http://123.1.175.43:8080','http://123.110.105.61:8088','http://123.110.75.213:9064','http://123.125.104.242:80','http://123.125.114.167:80','http://123.125.19.44:80','http://123.138.184.228:80','http://123.138.185.50:80','http://123.155.155.53:80','http://123.193.183.114:8088','http://123.205.18.108:9064','http://123.205.32.82:8088','http://123.205.97.127:8088','http://123.30.58.190:3128','http://124.248.190.220:8080','http://124.88.67.13:83','http://124.88.67.13:843','http://124.95.163.102:80','http://125.162.214.244:80','http://125.164.62.160:80','http://125.24.79.197:80','http://125.39.66.67:80','http://125.39.66.68:80','http://125.88.193.205:80','http://125.88.215.120:80','http://128.199.113.225:8080','http://128.199.195.26:3128','http://128.199.238.109:80','http://128.199.77.145:3128','http://139.0.25.146:8080','http://14.199.114.63:8088','http://140.125.47.102:9064','http://159.104.6.90:80','http://159.8.36.242:3128','http://162.208.49.45:8089','http://165.132.27.110:8080','http://175.100.86.219:8080','http://175.43.20.95:80','http://177.12.14.26:80','http://177.69.195.4:3128','http://177.84.241.107:3128','http://180.153.100.242:80','http://180.153.100.242:81','http://180.153.100.242:83','http://180.153.100.242:84','http://180.153.100.242:85','http://180.153.100.242:86','http://180.177.182.242:9064','http://180.177.71.18:9064','http://180.250.88.174:3128','http://180.254.108.103:3128','http://180.254.69.48:80','http://182.118.23.7:8081','http://182.118.31.110:80','http://182.118.31.46:80','http://182.16.15.26:3128','http://182.235.184.16:8088','http://182.239.127.134:80','http://182.239.127.136:80','http://182.239.127.137:80','http://182.239.127.139:80','http://182.239.127.139:81','http://182.239.127.139:82','http://182.239.127.140:80','http://182.239.127.140:81','http://182.239.127.140:82','http://182.239.95.134:80','http://182.239.95.136:80','http://182.239.95.137:80','http://182.239.95.139:80','http://182.253.33.129:3128','http://182.93.234.190:8080','http://182.93.241.150:8080','http://182.93.83.101:80','http://183.207.224.12:80','http://183.207.224.13:80','http://183.207.224.14:80','http://183.207.224.42:80','http://183.207.224.43:80','http://183.207.224.44:80','http://183.207.224.45:80','http://183.207.224.50:80','http://183.207.224.50:81','http://183.207.224.50:82','http://183.207.224.50:83','http://183.207.224.50:84','http://183.207.224.50:85','http://183.207.224.50:86','http://183.207.224.51:80','http://183.207.224.51:81','http://183.207.224.51:82','http://183.207.224.51:83','http://183.207.224.51:84','http://183.207.224.51:85','http://183.207.224.51:86','http://183.207.224.52:80','http://183.207.224.52:81','http://183.207.224.52:82','http://183.207.224.52:83','http://183.207.224.52:85','http://183.207.224.52:86','http://183.207.228.114:80','http://183.207.228.115:80','http://183.207.228.116:80','http://183.207.228.117:80','http://183.207.228.119:80','http://183.207.228.122:80','http://183.207.228.123:80','http://183.207.228.22:80','http://183.207.228.22:81','http://183.207.228.22:82','http://183.207.228.22:83','http://183.207.228.22:84','http://183.207.228.22:85','http://183.207.228.22:86','http://183.207.228.41:80','http://183.207.228.42:80','http://183.207.228.43:80','http://183.207.228.44:80','http://183.207.228.50:80','http://183.207.228.50:81','http://183.207.228.50:82','http://183.207.228.50:83','http://183.207.228.50:84','http://183.207.228.50:85','http://183.207.228.51:80','http://183.207.228.51:81','http://183.207.228.51:82','http://183.207.228.51:83','http://183.207.228.51:85','http://183.207.228.52:80','http://183.207.228.52:81','http://183.207.228.52:83','http://183.207.228.52:84','http://183.207.228.52:85','http://183.207.228.52:86','http://183.207.228.54:80','http://183.207.228.54:82','http://183.207.228.54:83','http://183.207.228.54:84','http://183.207.228.54:85','http://183.207.228.54:86','http://183.207.228.56:80','http://183.207.228.57:80','http://183.207.228.58:80','http://183.207.228.60:80','http://183.207.228.8:80','http://183.207.228.9:61616','http://183.207.228.9:80','http://183.207.228.9:82','http://183.207.228.9:83','http://183.207.228.9:84','http://183.207.228.9:86','http://183.207.228.9:89','http://183.207.229.130:81','http://183.207.229.130:82','http://183.207.229.130:83','http://183.207.229.130:85','http://183.207.229.137:6969','http://183.207.229.137:7070','http://183.207.229.137:8000','http://183.207.229.137:8001','http://183.207.229.137:8080','http://183.207.229.137:8088','http://183.207.229.137:8089','http://183.207.229.137:88','http://183.207.229.137:8888','http://183.207.229.137:9001','http://183.207.229.137:9090','http://183.207.229.137:9999','http://183.207.229.138:6969','http://183.207.229.138:7070','http://183.207.229.138:8000','http://183.207.229.138:8001','http://183.207.229.138:8080','http://183.207.229.138:8086','http://183.207.229.138:8088','http://183.207.229.138:8089','http://183.207.229.138:8090','http://183.207.229.138:9001','http://183.207.229.138:9090','http://183.207.229.138:9999','http://183.207.229.139:80','http://183.207.229.139:8088','http://183.207.229.139:8090','http://183.207.229.139:88','http://183.207.229.15:80','http://183.207.229.17:80','http://183.207.229.17:9000','http://183.207.229.19:80','http://183.207.229.19:8081','http://183.207.229.19:81','http://183.207.229.19:82','http://183.207.229.19:9090','http://183.207.237.11:80','http://183.207.237.11:81','http://183.207.237.11:82','http://183.207.237.18:80','http://183.207.237.18:82','http://183.207.237.18:83','http://183.207.237.18:84','http://183.207.237.18:85','http://183.222.251.247:8123','http://183.224.1.30:80','http://183.228.235.184:8088','http://183.61.240.126:1080','http://183.61.240.126:80','http://183.89.225.240:3128','http://186.46.185.186:8080','http://186.88.53.211:9064','http://186.91.81.95:9064','http://186.92.55.121:9064','http://186.94.10.54:9064','http://187.160.240.140:3128','http://188.166.17.183:8080','http://189.89.159.122:330','http://189.89.159.122:45668','http://190.10.156.194:8888','http://190.121.230.148:8080','http://190.167.243.11:8080','http://190.199.91.46:9064','http://190.201.28.191:9064','http://190.202.192.53:9064','http://190.204.21.244:9064','http://190.206.163.1:9064','http://190.206.236.66:9064','http://190.206.239.235:9064','http://190.254.1.201:9090','http://190.254.1.202:8080','http://190.52.192.1:8080','http://190.74.32.229:9064','http://195.114.125.81:8080','http://195.114.129.171:3128','http://199.200.120.37:7808','http://200.109.230.138:80','http://200.109.230.139:80','http://200.109.230.140:80','http://200.109.230.141:80','http://200.123.162.45:8080','http://200.178.118.82:3128','http://200.178.118.82:80','http://200.30.202.238:8080','http://201.186.26.255:9064','http://201.217.128.74:3128','http://201.218.223.50:3128','http://201.221.131.203:8080','http://201.242.85.163:9064','http://201.243.147.200:9064','http://201.248.251.13:9064','http://202.102.27.72:80','http://202.106.16.36:3128','http://202.108.23.247:80','http://202.114.144.15:8088','http://202.119.25.227:9999','http://202.119.25.228:9999','http://202.119.25.69:9999','http://202.119.25.70:9999','http://202.119.25.71:9999','http://202.119.25.72:9999','http://202.119.25.73:9999','http://202.138.233.145:8080','http://202.154.30.238:80','http://202.169.52.205:3128','http://202.171.253.74:86','http://202.28.120.10:8080','http://202.29.235.130:3129','http://202.43.191.114:3128','http://202.49.183.14:8080','http://202.77.115.71:54321','http://202.77.119.114:3128','http://202.92.205.34:8080','http://202.99.16.28:3128','http://203.151.21.184:3128','http://203.172.172.22:8080','http://203.172.209.222:8080','http://203.172.212.46:8080','http://203.176.140.226:8080','http://203.192.10.66:80','http://203.218.140.69:8118','http://203.70.194.170:8080','http://203.81.67.86:8080','http://209.177.93.6:80','http://210.101.131.231:8080','http://210.101.131.232:8080','http://210.51.2.202:8090','http://210.52.217.97:80','http://211.162.0.170:80','http://218.188.16.123:8080','http://218.203.54.30:80','http://218.203.54.31:80','http://218.204.141.204:8118','http://218.207.195.206:80','http://218.207.195.206:8000','http://218.207.195.206:8080','http://218.23.27.18:9797','http://218.27.136.164:8081','http://218.4.236.117:80','http://218.59.144.120:80','http://218.59.144.120:81','http://218.59.144.95:80','http://218.59.144.95:81','http://218.65.132.45:8081','http://219.143.238.174:8080','http://219.223.189.204:3128','http://219.246.65.143:3128','http://219.246.90.162:3128','http://219.68.233.62:9064','http://219.71.118.103:9064','http://219.85.253.168:9064','http://219.93.183.106:8080','http://220.181.32.106:80','http://221.10.102.203:80','http://221.10.102.203:81','http://221.10.102.203:82','http://221.10.102.203:83','http://221.12.173.130:3128','http://221.130.199.222:80','http://221.130.199.224:80','http://221.130.81.136:1337','http://221.172.136.86:9000','http://221.176.14.72:80','http://221.181.73.45:80','http://221.193.249.140:3128','http://221.7.43.71:1337','http://222.124.196.42:8080','http://222.124.218.83:8080','http://222.33.41.228:80','http://222.35.185.129:8080','http://222.39.87.140:8118','http://222.73.233.134:80','http://222.73.233.135:80','http://222.73.233.136:80','http://222.87.129.218:80','http://222.87.129.218:81','http://222.87.129.218:843','http://223.18.140.82:8088','http://223.82.245.168:80','http://223.83.131.168:8123','http://223.85.17.157:8123','http://223.85.22.54:8123','http://223.86.211.80:8123','http://223.86.64.46:8123','http://223.86.66.223:8123','http://27.116.62.75:8080','http://27.200.89.238:9797','http://31.25.142.216:3128','http://31.7.232.102:3128','http://36.250.74.87:80','http://36.250.74.87:8102','http://36.250.74.87:8103','http://36.250.74.88:80','http://36.250.74.88:8102','http://36.250.74.88:8103','http://36.73.186.106:80','http://41.160.80.194:80','http://41.190.57.175:8080','http://41.207.40.22:3128','http://41.216.159.158:8080','http://41.222.196.52:8080','http://41.223.119.156:3128','http://41.78.208.90:8080','http://41.79.71.40:8080','http://42.236.33.176:80','http://42.236.33.177:80','http://42.236.33.178:80','http://42.236.33.179:80','http://42.236.33.180:80','http://46.137.170.174:443','http://46.173.169.48:3128','http://49.1.245.234:3128','http://49.1.245.237:3128','http://49.1.245.238:3128','http://5.56.61.26:10098','http://5.56.61.26:10241','http://5.56.61.26:12206','http://5.56.61.26:12313','http://5.56.61.26:12369','http://5.56.61.26:15322','http://50.206.39.140:8080','http://58.242.249.14:33942','http://58.242.249.52:17657','http://58.246.199.122:3128','http://58.251.78.71:8088','http://58.252.167.103:80','http://58.252.72.179:3128','http://58.65.241.226:8080','http://58.96.181.169:3128','http://58.99.120.122:8088','http://59.124.241.199:8080','http://60.13.74.183:843','http://60.18.147.42:80','http://60.213.189.170:3988','http://60.5.252.76:80','http://60.55.49.9:3128','http://61.133.116.37:3128','http://61.156.3.166:80','http://61.156.35.2:3128','http://61.158.173.188:9797','http://61.158.173.188:9999','http://61.162.223.41:9797','http://61.163.165.250:9797','http://61.184.192.42:80','http://61.232.6.164:8081','http://61.53.143.179:80','http://61.54.221.200:3128','http://61.7.147.83:8080','http://61.7.213.58:3128','http://62.205.216.247:21320','http://62.82.58.99:8080','http://66.225.231.173:7808','http://66.35.68.145:3127','http://66.35.68.145:7808','http://66.35.68.145:8089','http://69.164.213.244:3128','http://69.197.148.18:3127','http://69.197.148.18:7808','http://69.197.148.18:8089','http://77.50.220.92:8080','http://77.50.238.100:5555','http://78.189.30.243:8080','http://78.24.221.193:3128','http://79.142.57.118:3128','http://80.63.55.3:8080','http://80.95.113.66:3128','http://81.163.88.65:8080','http://81.216.10.74:8118','http://82.144.204.41:3128','http://82.99.180.106:3128','http://83.55.33.54:8080','http://86.107.110.73:3127','http://86.107.110.73:7808','http://87.120.58.129:8080','http://87.245.167.75:3128','http://88.132.82.236:8088','http://88.150.136.179:3129','http://88.150.136.180:3129','http://88.159.52.39:80','http://89.249.207.65:3128','http://91.139.246.123:9064','http://91.196.48.196:9999','http://91.215.108.131:3130','http://93.191.133.247:4444','http://94.23.23.60:80','http://95.141.35.81:15692','http://95.188.78.80:3130','http://95.215.55.58:8080','http://94.242.238.5:443']

proxy_test(proxy_list)
